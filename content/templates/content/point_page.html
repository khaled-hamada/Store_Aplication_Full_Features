{% extends './base.html' %}
{% block content %}

<div class="select-date text-center font-weight-bold p-3 mb-4">
  <div class="bg-light p-2 rounded">
    {{point.name}}
  </div>
</div>

<div>
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item">النقاط</li>
      <li class="breadcrumb-item">{{point.name}}</li>
    </ol>
  </nav>
</div>

<div class="form-group row">
  <label for="inputPassword" class="col-sm-3 font-weight-bold col-form-label">اجمالي البضاعة الموجودة</label>
  <div class="col-sm-9">
  <div class="input-group mb-3">
      <span  class="form-control text-right" id="price-for-unit" aria-label="Amount (to the nearest dollar)">{{all_products_count}}   صنف</span>
  </div>
  </div>
</div>


<!-- start seperator -->
<div style="border-top: 7px solid #1abc9c;" class="my-5"></div>
<!-- end seperator -->

<div class="row font-weight-bold justify-content-around mt-5">

    {%if user.groups.first.name == "managers"%}
    <div class="row">
      <a href="{%url 'content:add_new_point_sellings' point.id%}" target="_blank">
        <button class="btn  btn-sm btn-hover font-weight-bold px-2 mx-1">تسجيل  مبيعات النقطة</button>
      </a>

      <a href="{%url 'content:restore_point_product_store' point.id%}" target="_blank">
        <button class="btn btn-sm btn-danger font-weight-bold px-5 mx-1">استرجاع بضاعة للمخزن</button>
      </a>
      <a href="{%url 'content:point_to_point_product' point.id%}" target="_blank">
        <button class="btn btn-sm btn-warning font-weight-bold px-5 mx-1">نقل بضاعة من نقطة لاخرى</button>
      </a>

      <div class="">
        <a href="{%url 'content:points'  %}">
            <button class="btn btn-sm btn-hover font-weight-bold px-5 mx-2">رجوع</button>
        </a>
        </div>
    </div>


    <div class="row m-2">
      <a href="{%url 'content:all_point_payments' point.id%}" target="_blank">
        <button class="btn  btn-sm btn-hover font-weight-bold px-2 mx-1">كشف ب مبيعات النقطة</button>
      </a>

      <a href="{%url 'content:all_point_products' point.id%}" target="_blank">
        <button class="btn btn-sm btn-info font-weight-bold px-5 mx-1">البضائع الموجودة بالنقطة</button>
      </a>
      <a href="{%url 'content:all_point_moved_products' point.id%}" target="_blank">
        <button class="btn btn-sm btn-primary font-weight-bold px-5 mx-1">البضائع المنقولة للنقطة</button>
      </a>

      <div class="">
        <a href="{%url 'content:all_point_restored_bills' point.id  %}">
            <button class="btn btn-sm btn-danger font-weight-bold px-5 mx-2 " target="_blank">البضائع المسترجعة للنقطة</button>
        </a>
        </div>
    </div>

      {%endif%}
</div>
<!-- <div class="mt-5"> -->
  {%if user.groups.first.name == "managers"%}


  {%endif%}


<!-- start seperator -->
<div style="border-top: 7px solid #1abc9c;" class="my-5"></div>
<!-- end seperator -->

<div class="row text-danger font-weight-bold justify-content-around mt-5">
  <p>فواتير مسترجعة اليوم  <span class="today-date"></span></p>
</div>
<table class="table">
    <thead class="thead-dark">
      <tr>
        <th scope="col">#</th>
        <th scope="col">الصنف</th>
        <th scope="col">ك.ق</th>
        <th scope="col">ق.ق</th>
        <th scope="col">ك.ج</th>
        <th scope="col">ق.ج</th>
        <th scope="col">سعر البيع</th>
        <th scope="col">الخصم للقطعة</th>
        <th scope="col">الخصم الكلى</th>

        <th scope="col">الاجمالي</th>
        <th scope="col text-danger">قيمة المسترجع</th>

        <th scope="col" class="text-danger">الكمية المسترجعة</th>
        <th scope="col" class="text-danger">الكمية المباعة</th>
        <th scope="col">تاريخ الفاتورة</th>

      </tr>
    </thead>
    <tbody>
      {% for bill in restored_bills %}
      <tr>
        <th scope="row">{{forloop.counter}}</th>

        <td>{{bill.product.name}}</td>
        <td>{{bill.quantity_packet_old}}</td>
        <td>{{bill.quantity_old}}</td>
        <td>{{bill.quantity_packet_new}}</td>
        <td>{{bill.quantity_new}}</td>
        <td>{{bill.product.unit_sell_price}}</td>
        <td>{{bill.discount_per_unit}}</td>
        <td>{{bill.total_discount}}</td>
        <td>{{bill.money_quantity_sell}}</td>
        <td>{{bill.required_amount}}</td>


        <td>{{bill.restored_amount}}</td>
        <td>{{bill.restored_amount_cost_ad}}</td>

        <td>{{bill.date}}</td>

      </tr>
      {% endfor %}

    </tbody>
</table>
<hr class="my-5">
<div class="container mt-5">
  <div class='row text-center'>
    <div class="col-3 bg-dark text-light font-weight-bolder p-3">الاجمالي بيع بعد الخصم</div>
    <div class="col-3 font-weight-bolder  p-3">{{restored_total_bills_sell}}</div>
    <div class="col-3 bg-dark text-light font-weight-bolder p-3">الاجمالي شراء</div>
    <div class="col-3 font-weight-bolder  p-3">{{restored_total_bills_buy}}</div>
  </div>

<!-- start seperator -->








    {% if failed == 1 %}
    <div class="alert alert-danger text-center mt-3 mb-0" role="alert">
      خطأ لم يتم تحديث البيانات . تأكد من اسم المنتج و الكمية الصحيحة
    </div>
    {%elif success %}
    <div class="alert alert-success text-center mt-3 mb-0" role="alert">
      تم حفظ البيانات
    </div>
    {% endif %}

    <script>
      const navLinks = document.querySelectorAll(".nav-item")
      for (link of navLinks){
          link.classList.remove('active-link')
      }
      navLinks[7].classList.add('active-link');

    </script>


{%endblock%}
